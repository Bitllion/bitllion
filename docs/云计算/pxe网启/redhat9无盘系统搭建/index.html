<!DOCTYPE html>
<html
  lang="zh"
  dir="ltr"
  
><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Redhat9无盘系统搭建 | 云计算 | 一言</title>

<meta name="generator" content="Hugo Eureka 0.9.3" />
<link rel="stylesheet" href="/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css">
<script defer src="/js/eureka.min.e8043b71b627e3cfd9b2a5de56adf007f5af83dee672ca0c186aa2e29a10d6f648632064d0c00b2fa4d1b11e0f196af3.js"></script>













<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&amp;family=Noto&#43;Serif&#43;SC:wght@400;600;700&amp;display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js"
   crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js"
     crossorigin></script>
<link rel="stylesheet" href="/css/highlightjs.min.2958991528e43eb6fc9b8c4f2b8e052f79c4010718e1d1e888a777620e9ee63021c2c57ec7417a3108019bb8c41943e6.css" media="print" onload="this.media='all';this.onload=null">


<script defer type="text/javascript" src="/js/fontawesome.min.a975d08212c5439f29e6074e7ad58e159ae1ef5efb6a31962fa3b6885557e794dd9315f4a8a16d705066d023f4eaaf07.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
   integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" 
  integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
   integrity="sha384-&#43;XBljXPPiv&#43;OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js" 
  integrity="sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0"  crossorigin></script>


<link rel="icon" type="image/png" sizes="32x32" href="/images/icon_huffaf4145a3e4a325d53a2947ed7b6f87_11450_32x32_fill_box_center_3.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/icon_huffaf4145a3e4a325d53a2947ed7b6f87_11450_180x180_fill_box_center_3.png">

<meta name="description"
  content="一、安装和配置RedHat9.4 1.安装过程略 2.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"文档",
      "item":"/docs/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"云计算",
      "item":"/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/"},{
      "@type": "ListItem",
      "position": 3 ,
      "name":"PXE网启",
      "item":"/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/"},{
      "@type": "ListItem",
      "position": 4 ,
      "name":"Redhat9无盘系统搭建",
      "item":"/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/redhat9%E6%97%A0%E7%9B%98%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/redhat9%E6%97%A0%E7%9B%98%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/"
    },
    "headline": "Redhat9无盘系统搭建 | 云计算 | 一言","datePublished": "2025-03-07T11:39:51+08:00",
    "dateModified": "2025-03-07T11:39:51+08:00",
    "wordCount":  795 ,
    "publisher": {
        "@type": "Person",
        "name": "WANG Chucheng",
        "logo": {
            "@type": "ImageObject",
            "url": "/images/icon.png"
        }
        },
    "description": "一、安装和配置RedHat9.4 1.安装过程略 2."
}
</script><meta property="og:title" content="Redhat9无盘系统搭建 | 云计算 | 一言" />
<meta property="og:type" content="article" />


<meta property="og:image" content="/images/icon.png">


<meta property="og:url" content="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/redhat9%E6%97%A0%E7%9B%98%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/" />




<meta property="og:description" content="一、安装和配置RedHat9.4 1.安装过程略 2." />




<meta property="og:locale" content="zh" />




<meta property="og:site_name" content="一言" />






<meta property="article:published_time" content="2025-03-07T11:39:51&#43;08:00" />


<meta property="article:modified_time" content="2025-03-07T11:39:51&#43;08:00" />



<meta property="article:section" content="docs" />





  <body class="flex min-h-screen flex-col">
    <header
      class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"
    >
      <div class="mx-auto w-full max-w-screen-xl"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="me-6 text-primary-text text-xl font-bold">一言</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/docs/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  me-4">文档</a>
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">文章</a>
            <a href="https://pan.bitllion.top:88/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">云盘</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka" name="Light">浅色</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Dark">深色</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Auto">自动</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', switchDarkMode)
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }

    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script>
</div>
    </header>
    <main class="grow pt-16">
        <div class="pl-scrollbar">
          <div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8">


<div class="lg:pt-12">
    <div class="flex flex-col md:flex-row bg-secondary-bg rounded">
        <div class="md:w-1/4 lg:w-1/5 border-e">
            <div class="sticky top-16 pt-6">
                















<div id="sidebar-title" class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text">
    <span class="font-semibold">目录</span>
    <i class='fas fa-caret-right ms-1'></i>
</div>

<div id="sidebar-toc"
    class="hidden md:block overflow-y-auto mx-6 md:mx-0 pe-6 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent">
    <div class="flex flex-wrap ms-4 -me-2 p-2 bg-secondary-bg md:bg-primary-bg rounded">
        <a class=" hover:text-eureka"
            href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a>
        
        
        


    </div>
    
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/">PXE网启</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" text-eureka  hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/redhat9%E6%97%A0%E7%9B%98%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/">Redhat9无盘系统搭建</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/maas%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/">Maas安装和使用</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/gpu/">GPU</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/gpu/%E5%A4%9A%E6%9C%BAnccl-tests%E6%B5%8B%E8%AF%95/">多机nccl Tests测试</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/gpu/gpu%E8%B5%84%E6%BA%90%E6%B5%8B%E8%AF%95%E9%80%9A%E7%94%A8%E6%8A%A5%E5%91%8A/">Gpu资源测试通用报告</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/gpu/nvidia%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">Nvidia常见问题及解决办法</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/kvm/">Kvm</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/kvm/ubuntu22.04%E5%AE%89%E8%A3%85ovs%E5%92%8C%E9%85%8D%E7%BD%AEkvm%E8%99%9A%E6%8B%9F%E5%8C%96/">Ubuntu22.04安装ovs和配置KVM虚拟化</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/kvm/%E6%8E%A2%E7%B4%A2%E5%9F%BA%E4%BA%8Espice%E5%8D%8F%E8%AE%AE%E7%9A%84vdi%E4%BA%91%E6%A1%8C%E9%9D%A2/">探索基于SPICE协议的VDI云桌面</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/">Devops</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/clush%E8%BF%90%E7%BB%B4/">Clush运维</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/nexus3%E9%95%9C%E5%83%8F%E6%BA%90%E6%90%AD%E5%BB%BA/">Nexus3镜像源搭建</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/prometheus%E7%9B%91%E6%8E%A7%E9%83%A8%E7%BD%B2/">Prometheus监控部署</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/docker%E9%83%A8%E7%BD%B2iredmail%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F/">Docker部署iredmail邮件系统</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/centos7%E9%83%A8%E7%BD%B2nis%E6%9C%8D%E5%8A%A1/">Centos7部署nis服务</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/ubuntu%E9%83%A8%E7%BD%B2ganglia%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/">Ubuntu部署ganglia监控系统</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/ubuntu%E6%90%AD%E5%BB%BAnis%E6%9C%8D%E5%8A%A1/">Ubuntu搭建nis服务</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/%E5%90%84%E5%8E%82%E5%95%86%E6%9C%8D%E5%8A%A1%E5%99%A8ipmi%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/">各厂商服务器IPMI默认密码</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/ipmitool%E6%95%99%E7%A8%8B/">Ipmitool 教程</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/nvidia%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E5%AE%89%E8%A3%85/">Nvidia显卡驱动安装</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/ldap%E7%94%A8%E6%88%B7%E7%BB%9F%E4%B8%80%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85/">Ldap用户统一认证服务安装</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/devops/nexus-%E9%85%8D%E7%BD%AEapt-hosted/"></a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E7%BD%91%E7%BB%9C/">网络</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E7%BD%91%E7%BB%9C/pve%E4%B8%8B%E9%85%8D%E7%BD%AEib%E8%99%9A%E6%8B%9F%E5%8C%96/">Pve下配置ib虚拟化</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E7%BD%91%E7%BB%9C/centos7%E9%83%A8%E7%BD%B2ovs/">Centos7部署ovs</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E7%BD%91%E7%BB%9C/ib%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/">IB网络配置</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
    
    
    <li class="py-2">
        <div class=" pb-2 ">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E5%AD%98%E5%82%A8/">存储</a>
        </div>
        
        
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E5%AD%98%E5%82%A8/centos7%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2luster/">Centos7离线部署luster</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E5%AD%98%E5%82%A8/lvm%E5%AE%9E%E6%88%98/">Lvm实战</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/%E5%AD%98%E5%82%A8/rh8%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85lustre/">RH8编译安装Lustre</a>
        </div>
        
    </li>
    
    
</ul>

        
    </li>
    
    
</ul>

</div>







            </div>

        </div>
        <div class="w-full md:w-3/4 lg:w-4/5 pb-8 pt-2 md:pt-8">
            <div class="flex">
                <div class="w-full lg:w-3/4 px-6">
                    <article class="prose">
  <h1 class="mb-4">Redhat9无盘系统搭建</h1>

  <div
  class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"
>
  <div class="me-6 my-2">
    <i class="fas fa-calendar me-1"></i>
    <span
      >2025-03-07</span
    >
  </div>
  <div class="me-6 my-2">
    <i class="fas fa-clock me-1"></i>
    <span>4分钟阅读时长</span>
  </div>

  

  
</div>


  
  

  <h2 id="一安装和配置redhat94">一、安装和配置RedHat9.4</h2>
<h3 id="1安装过程略">1.安装过程略</h3>
<h3 id="2配置本地iso源">2.配置本地iso源</h3>
<p>查看U盘（iso刻录到U盘中了）的设备文件路径</p>
<pre><code class="language-bash">[root@pxeserver ~]# lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda           8:0    1 118.1G  0 disk
├─sda1        8:1    1  10.3G  0 part
└─sda2        8:2    1   6.9M  0 part
nvme0n1     259:0    0 953.9G  0 disk
├─nvme0n1p1 259:1    0     1G  0 part
├─nvme0n1p2 259:2    0     1G  0 part
├─nvme0n1p3 259:3    0     1G  0 part
├─nvme0n1p4 259:4    0     1G  0 part /boot/efi
├─nvme0n1p5 259:5    0     1G  0 part /boot
└─nvme0n1p6 259:6    0 948.9G  0 part /
</code></pre>
<p>创建挂载点</p>
<pre><code class="language-bash">mkdir /mnt/usb
mount /dev/sda /mnt/usb
</code></pre>
<p>如果U盘拔掉，需要重新挂载，我们将其内容同步到一个新的目录</p>
<pre><code class="language-bash">mkdir /iso
rsync -aHAX --progress /mnt/usb/ /iso/
</code></pre>
<p>同步完成后，我们创建一个repo文件</p>
<pre><code class="language-bash">tee /etc/yum.repos.d/local-iso.repo &gt; /dev/null &lt;&lt;EOF
[local-iso]
name=RH9 Local Repo
baseurl=file:///iso/BaseOS/
enabled=1
gpgcheck=0

[local-appstream]
name=RH9 AppStream
baseurl=file:///iso/AppStream/
enabled=1
gpgcheck=0
EOF
</code></pre>
<p>重建索引</p>
<pre><code>yum makecache
</code></pre>
<h3 id="3禁用selinux和防火墙">3.禁用selinux和防火墙</h3>
<pre><code class="language-BASH">systemctl disable firewalld --now
sed -i 's/^SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config
grubby --update-kernel ALL --args selinux=0
reboot
</code></pre>
<p>禁用selinux是为了设置chroot无盘系统后的密码，禁用防火墙省去开端口的过程</p>
<h2 id="二构建无盘系统">二、构建无盘系统</h2>
<h3 id="1设置环境变量">1.设置环境变量</h3>
<pre><code class="language-bash">echo 'export NFSROOT=/pxe/diskless/rh9' &gt;&gt; ~/.bashrc
source ~/.bashrc
mkdir -p ${NFSROOT}
</code></pre>
<h3 id="2安装基础环境">2.安装基础环境</h3>
<pre><code class="language-bash"> dnf group -y install &quot;Server&quot; --installroot=${NFSROOT}
</code></pre>
<h3 id="3配置无盘系统的iso镜像源">3.配置无盘系统的iso镜像源</h3>
<pre><code class="language-bash">rsync -aHAX --progress /iso/ ${NFSROOT}/iso
tee ${NFSROOT}/etc/yum.repos.d/local-iso.repo &gt; /dev/null &lt;&lt;EOF
[local-iso]
name=RH9 Local Repo
baseurl=file:///iso/BaseOS/
enabled=1
gpgcheck=0

[local-appstream]
name=RH9 AppStream
baseurl=file:///iso/AppStream/
enabled=1
gpgcheck=0
EOF
</code></pre>
<h3 id="4安装其他依赖">4.安装其他依赖</h3>
<pre><code class="language-bash">dnf install -y perl-File-Compare autoconf perl perl-File-Copy tk gcc gcc-c++ gcc-gfortran nfs-utils git   kernel-devel  git  make cmake python3-pip python3-devel patch tmux glibc-langpack-en ipmitool 
dnf install -y  --installroot=${NFSROOT} --releasever=/ perl-File-Compare autoconf perl perl-File-Copy tk gcc gcc-c++ gcc-gfortran nfs-utils git   kernel-devel  git  make cmake python3-pip python3-devel patch tmux  glibc-langpack-en ipmitool
</code></pre>
<h3 id="5配置自动挂载">5.配置自动挂载</h3>
<p>编辑  <strong>$NFSROOT/etc/fstab</strong></p>
<pre><code>none /tmp tmpfs defaults 0 0
tmpfs /dev/shm tmpfs defaults 0 0
sysfs /sys sysfs defaults 0 0
proc /proc proc defaults 0 0
</code></pre>
<h3 id="6配置hostname">6.配置hostname</h3>
<p>编辑 **$NFSROOT/etc/hosts **和 <strong>/etc/hosts</strong></p>
<pre><code>10.0.0.1	gpu01
10.0.0.2	gpu02
10.0.0.3	gpu03
10.0.0.4	gpu04
10.0.0.5	gpu05
10.0.0.6	gpu06
10.0.0.7	gpu07
10.0.0.8	gpu08
10.0.0.9	gpu09
10.0.0.10	gpu10
10.0.0.11	gpu11
10.0.0.12	gpu12
10.0.0.13	gpu13
10.0.0.14	gpu14
10.0.0.15	gpu15
10.0.0.16	gpu16
10.0.0.17	gpu17
10.0.0.18	gpu18
10.0.0.19	gpu19
10.0.0.20	gpu20
10.0.0.21	gpu21
10.0.0.22	gpu22
10.0.0.23	gpu23
10.0.0.24	gpu24
10.0.0.25	gpu25
10.0.0.26	gpu26
10.0.0.27	gpu27
10.0.0.28	gpu28
10.0.0.29	gpu29
10.0.0.30	gpu30
10.0.0.31	gpu31
10.0.0.32	gpu32
10.0.0.100 master
</code></pre>
<p>hostname ip 对应按照自己实际情况编辑</p>
<h3 id="7配置whereami">7.配置whereami</h3>
<p>编辑 <strong>$NFSROOT/bin/whereami</strong></p>
<pre><code class="language-bash">#!/bin/bash
# finds node's hostname based on matching IP in /etc/hosts
PATH=/sbin:/bin:/usr/sbin:/usr/bin
IP=`ifconfig | egrep 'inet.*broadcast' \
| sed -e 's/.*inet \(.*\).*netmask.*/\1/'`
grep $IP /etc/hosts | /usr/bin/awk '{print $2}'
</code></pre>
<p>执行命令：</p>
<pre><code class="language-bash">chmod +x ${NFSROOT}/bin/whereami
</code></pre>
<h3 id="8配置rclocal">8.配置rc.local</h3>
<p>和上面的whereami结合，根据分配的ip 自动变更hostname</p>
<p>覆写  <strong>$NFSROOT/etc/rc.local</strong></p>
<pre><code class="language-shell">#!/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
# set hostname
hostname `/bin/whereami`
touch /var/lock/subsys/local
</code></pre>
<p>执行命令：</p>
<pre><code class="language-shell">chmod +x ${NFSROOT}/etc/rc.local
</code></pre>
<h3 id="9配置root用户">9.配置root用户</h3>
<p>依次执行命令</p>
<pre><code class="language-shell">chroot ${NFSROOT}
passwd root
exit
</code></pre>
<p>其中第二条命令输入密码后如果报错认证失败，那是因为2.1 的操作未做/未生效</p>
<h3 id="10创建基于ram的引导内核">10.创建基于ram的引导内核</h3>
<p>依次执行命令</p>
<pre><code class="language-shell">echo 'add_dracutmodules+=&quot;nfs&quot;' &gt;&gt; $NFSROOT/etc/dracut.conf
chroot $NFSROOT
dracut --no-hostonly --nolvmconf -m &quot;nfs network base&quot; --xz /boot/initramfs.pxe-$(uname -r) $(uname -r)
chmod ugo+r /boot/initramfs.pxe-$(uname -r)
exit
</code></pre>
<p>注意dracut生产pxe引导文件需要kernel一致，否则无法成功引导</p>
<h3 id="11配置ssh免密">11.配置ssh免密</h3>
<p>修改sshd_config 中PermitRootLogin 值为yes</p>
<h2 id="三配置http服务">三、配置http服务</h2>
<pre><code class="language-bash">wget https://slink.ltd/https://github.com/codeskyblue/gohttpserver/releases/download/1.1.4/gohttpserver_1.1.4_linux_amd64.tar.gz
tar xzf gohttpserver_1.1.4_linux_amd64.tar.gz -C /usr/bin/
</code></pre>
<p>配饰systemd服务</p>
<pre><code class="language-shell">cat &lt;&lt; EOF &gt;/etc/systemd/system/gohttpserver.service
[Unit]
Description=Systemd gohttpserver
After=network.target

[Service]
User=root
# Execute `systemctl daemon-reload` after ExecStart= is changed.
ExecStart=/usr/bin/gohttpserver -r /pxe/http --addr :80 --auth-type http
[Install]
WantedBy=multi-user.target
EOF
</code></pre>
<p>启动gohttp服务器</p>
<pre><code class="language-bash">mkdir /pxe/http
systemctl daemon-reload
systemctl enable gohttpserver --now
</code></pre>
<p>将上面的无盘系统的boot目录软链接到http目录下,方便后续配置</p>
<pre><code class="language-bash">mkdir /pxe/http/diskless
ln -s /pxe/diskless/rh9/boot /pxe/http/diskless/rh9
</code></pre>
<h2 id="四配置dnsmasq">四、配置dnsmasq</h2>
<p>dnsmasq集成了dhcp和tftp的功能
安装dnsmasq</p>
<pre><code class="language-bash">dnf install -y dnsmasq
</code></pre>
<p>创建tftp工作目录</p>
<pre><code class="language-BASH"> mkdir -p /pxe/tftp
</code></pre>
<p>将固件复制到tftp 目录下</p>
<pre><code>cp bin-x86_64-efi/ipxe.efi /pxe/tftp
</code></pre>
<p>编辑/etc/dnsmasq.conf</p>
<pre><code># 关闭DNS解析
port=0

#Setup the server to be your authoritative DHCP server
dhcp-authoritative

#Set the DHCP server to hand addresses sequentially
dhcp-sequential-ip

# 设置DHCP分发IP端范围、地址掩码、IP地址有效时间

dhcp-range=10.0.0.1,10.0.0.32,255.255.255.0,12h
dhcp-option=option:router,10.0.0.254
dhcp-option=option:dns-server,223.5.5.5

# 设置引导程序相对tftp根目录的路径

dhcp-match=set:bios,option:client-arch,0
dhcp-match=set:ipxe,175
dhcp-boot=tag:!ipxe,tag:bios,undionly.kpxe
dhcp-boot=tag:!ipxe,tag:!bios,ipxe.efi  #如果引导失败用这个 snponly.efi
dhcp-boot=tag:ipxe,boot.ipxe

# 设置tftp服务

enable-tftp
tftp-lowercase
dhcp-no-override
tftp-root=/pxe/tftp

#log
log-queries
log-dhcp
log-facility=/var/log/dnsmasq.log
</code></pre>
<p>启动dnsmasq服务</p>
<pre><code class="language-bash">systemctl enable dnsmasq --now
systemctl status dnsmasq
</code></pre>
<h2 id="五配置nfs服务器">五、配置nfs服务器</h2>
<h3 id="1安装">1.安装</h3>
<pre><code class="language-bash">dnf -y install nfs-utils
</code></pre>
<h3 id="2创建共享目录">2.创建共享目录</h3>
<pre><code class="language-bash">mkdir -p /pxe/diskless/rh9
chmod 755 /pxe
chmod 755 /pxe/diskless
chmod 1777 /pxe/diskless/rh9
</code></pre>
<h3 id="3配置etcexports">3.配置/etc/exports</h3>
<pre><code class="language-bash">echo '/pxe/diskless/rh9 *(rw,sync,no_root_squash)' &gt;&gt; /etc/exports
</code></pre>
<blockquote>
<p>参数含义：rw表⽰设置⽬录可读写sync表⽰数据会同步写⼊到内存和硬盘中，相反rsync表⽰数 据会先暂存于内存中，⽽⾮直接写⼊到硬盘中。no_root_squashNFS客⼾端连接服务端时如果使⽤ 的是root的话，那么对服务端分享的⽬录来说，也拥有root权限no_all_squash不论NFS客⼾端连接 服务端时使⽤什么⽤⼾，对服务端分享的⽬录来说都不会拥有匿名⽤⼾权限</p>
</blockquote>
<h3 id="4启动服务">4.启动服务</h3>
<pre><code class="language-bash">systemctl enable nfs-server --now
</code></pre>
<p>验证</p>
<pre><code class="language-bash">[root@pxeserver ~]# showmount -e localhost
Export list for localhost:
/pxe/diskless/rh9 *
</code></pre>
<h2 id="六配置ipxe">六、配置iPXE</h2>
<h3 id="1编译开启nfs功能的ipxe固件">1.编译开启NFS功能的ipxe固件</h3>
<p>官方提供的ipxe固件默认没有开启NFS功能，所以我们需要编译一个新的固件</p>
<pre><code class="language-bash">git clone https://github.com/ipxe/ipxe.git
cd ipxe/src
</code></pre>
<p>编辑 config目录下的general.h文件</p>
<pre><code class="language-bash">将
#undef DOWNLOAD_PROTO_NFS  /* Network File System Protocol */ 
修改成
#define DOWNLOAD_PROTO_NFS  /* Network File System Protocol */ 
</code></pre>
<p>在src目录下执行</p>
<pre><code class="language-bash">make bin-x86_64-efi/ipxe.efi -j
</code></pre>
<p>将固件复制到tftp⽬录下</p>
<pre><code class="language-bash">cp bin-x86_64-efi/ipxe.efi /pxe/tftp
</code></pre>
<h3 id="2配置ipxe-menu-脚本">2.配置ipxe menu 脚本</h3>
<p>编辑/pxe/tftp/boot.ipxe</p>
<pre><code class="language-bash">#!ipxe

set boot-url http://${next-server}

# Setup some basic convenience variables
set menu-timeout 3000

# Set default boot option to diskless CentOS 7
set menu-default rh9-diskless

######## MAIN MENU ###################
:start
menu Welcome to iPXE's Boot Menu
item
item --gap -- ------------------------- Utilities ------------------------------
item rh9-installer      Install rh9
item rh9-diskless       Diskless rh9
item --gap -- ------------------------------ Advanced ---------------------------------
item --key r reboot     [R] Reboot the Computer
item --key x exit       [X] Exit (boot local disk)
choose --default ${menu-default} --timeout ${menu-timeout} target &amp;&amp; goto ${target}

########## UTILITY ITEMS ####################
:failed
echo Booting failed, dropping to shell
goto start

:reboot
reboot

:exit
exit

:rh9-installer
initrd ${boot-url}/iso/rh9/images/pxeboot/initrd.img
kernel ${boot-url}/iso/rh9/images/pxeboot/vmlinuz
imgargs vmlinuz initrd=initrd.img inst.ks=${boot-url}/ks/ks-rh9.cfg inst.repo=${boot-url}/iso/rh9
boot || goto failed
goto start

:rh9-diskless
set args1 vga=791 boot=casper toram
set args2 netboot=nfs nfsroot=${next-server}:/pxe/diskless/rh9 root=/dev/nfs rw selinux=0 net.ifnames=0 biosdevname=0
initrd ${boot-url}/iso/rh9/images/pxeboot/initrd.img
kernel ${boot-url}/iso/rh9/images/pxeboot/vmlinuz
imgargs vmlinuz initrd=initrd.img ${args1} ${args2}
imgstat
boot || read void
</code></pre>
<p>物理机还需要拷贝下</p>
<pre><code class="language-bash">cp boot.ipxe autoexec.ipxe
</code></pre>
<p>上面的rh9-installer 只需要同步下iso文件</p>
<pre><code class="language-bash">rsync -aHAX --progress /iso/ /pxe/http/iso/rh9
</code></pre>
<h2 id="七无盘系统软件安装">七、无盘系统软件安装</h2>
<ol>
<li>
<p>IB驱动</p>
<p>下载合适版本的OFED驱动，解压，然后执行下面的命令</p>
<pre><code class="language-bash">./mlnxofedinstall  --force --with-nfsrdma --without-fw-update	
</code></pre>
<p>安装好后禁用openibd，否则会出现无盘系统initrmafs 链接nfs前网卡宕掉的情况</p>
<pre><code class="language-bash">systemctl disable openibd
</code></pre>
</li>
</ol>

</article>

                    
                    
                    

                    



                    
  <div
    class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"
  >
    <div>
      
    </div>
    <div class="mt-4 md:mt-0 md:text-right">
      
        <span class="text-primary-text block font-bold">下一页</span>
        <a href="/docs/%E4%BA%91%E8%AE%A1%E7%AE%97/pxe%E7%BD%91%E5%90%AF/maas%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/" class="block">Maas安装和使用</a>
      
    </div>
  </div>


                    



  <script id="utterances" src="https://utteranc.es/client.js"
            issue-term=pathname
            repo=Bitllion/hugoblogtalks
              theme=preferred-color-scheme
        crossorigin="anonymous"
        async>
</script>
<script>
    if (storageColorScheme == "Light") {
      document.getElementById('utterances').setAttribute('theme', 'github-light')
    } else if (storageColorScheme == "Dark") {
      document.getElementById('utterances').setAttribute('theme', 'github-dark')
    }
</script>

                </div>
                
                <div class="hidden lg:block lg:w-1/4">
                    
                    <div
  class="
    bg-secondary-bg
   prose sticky top-16 z-10 hidden px-6 py-4 lg:block"
>
  <h3>本页内容</h3>
</div>
<div
  class="sticky-toc 
    border-s
   hidden px-6 pb-6 lg:block"
>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#一安装和配置redhat94">一、安装和配置RedHat9.4</a>
      <ul>
        <li><a href="#1安装过程略">1.安装过程略</a></li>
        <li><a href="#2配置本地iso源">2.配置本地iso源</a></li>
        <li><a href="#3禁用selinux和防火墙">3.禁用selinux和防火墙</a></li>
      </ul>
    </li>
    <li><a href="#二构建无盘系统">二、构建无盘系统</a>
      <ul>
        <li><a href="#1设置环境变量">1.设置环境变量</a></li>
        <li><a href="#2安装基础环境">2.安装基础环境</a></li>
        <li><a href="#3配置无盘系统的iso镜像源">3.配置无盘系统的iso镜像源</a></li>
        <li><a href="#4安装其他依赖">4.安装其他依赖</a></li>
        <li><a href="#5配置自动挂载">5.配置自动挂载</a></li>
        <li><a href="#6配置hostname">6.配置hostname</a></li>
        <li><a href="#7配置whereami">7.配置whereami</a></li>
        <li><a href="#8配置rclocal">8.配置rc.local</a></li>
        <li><a href="#9配置root用户">9.配置root用户</a></li>
        <li><a href="#10创建基于ram的引导内核">10.创建基于ram的引导内核</a></li>
        <li><a href="#11配置ssh免密">11.配置ssh免密</a></li>
      </ul>
    </li>
    <li><a href="#三配置http服务">三、配置http服务</a></li>
    <li><a href="#四配置dnsmasq">四、配置dnsmasq</a></li>
    <li><a href="#五配置nfs服务器">五、配置nfs服务器</a>
      <ul>
        <li><a href="#1安装">1.安装</a></li>
        <li><a href="#2创建共享目录">2.创建共享目录</a></li>
        <li><a href="#3配置etcexports">3.配置/etc/exports</a></li>
        <li><a href="#4启动服务">4.启动服务</a></li>
      </ul>
    </li>
    <li><a href="#六配置ipxe">六、配置iPXE</a>
      <ul>
        <li><a href="#1编译开启nfs功能的ipxe固件">1.编译开启NFS功能的ipxe固件</a></li>
        <li><a href="#2配置ipxe-menu-脚本">2.配置ipxe menu 脚本</a></li>
      </ul>
    </li>
    <li><a href="#七无盘系统软件安装">七、无盘系统软件安装</a></li>
  </ul>
</nav>
</div>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    enableStickyToc();
  });
</script>

                    
                </div>
                
            </div>

        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        hljs.highlightAll();
        changeSidebarHeight();
        switchDocToc();
    })
</script>









          </div>
        </div>
      
    </main>
    <footer class="pl-scrollbar">
      <div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text"> Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
    </footer>
  </body>
</html>
